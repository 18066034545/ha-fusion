import{g as d,a as u,d as v}from"./2.C41V4jFO.js";function f(e,s,i){var t;const c=s.state;if(c===void 0)return;const{domain:n,service:r}=i.data;if(!(!((t=c.domain)===null||t===void 0)&&t.service)){const a=Object.assign(Object.assign({},c[n]),{[r]:{description:"",fields:{}}});s.setState({[n]:a})}l(e,s)}function b(e,s){if(e===void 0)return null;const{domain:i,service:t}=s.data,c=e[i];if(!c||!(t in c))return null;const n={};return Object.keys(c).forEach(r=>{r!==t&&(n[r]=c[r])}),{[i]:n}}const l=v((e,s)=>o(e).then(i=>s.setState(i,!0)),5e3),o=e=>u(e),m=(e,s)=>Promise.all([e.subscribeEvents(i=>f(e,s,i),"service_registered"),e.subscribeEvents(s.action(b),"service_removed")]).then(i=>()=>i.forEach(t=>t())),S=e=>d(e,"_srv",o,m),h=(e,s)=>S(e).subscribe(s);export{h as s};
